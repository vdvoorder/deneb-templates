{
    "data": {
      "values": [
        {"Category": "Actionable", "Actual Value": 500, "Target Value": 450},
        {"Category": "Bar", "Actual Value": 295, "Target Value": 300},
        {"Category": "Chart", "Actual Value": 205, "Target Value": 250}
      ]
    },
    "params": [{"name": "NearTargetBoundary", "value": 0.1}],
    "transform": [
      {
        "calculate": "if((abs(datum['Actual Value'] - datum['Target Value']) / datum['Target Value']) <= NearTargetBoundary, \"Near target\", if(datum['Actual Value'] > datum['Target Value'], \"Over target\", \"Under target\"))",
        "as": "ActualState"
      },
      {
        "calculate": "round(100 * abs(datum['Actual Value'] - datum['Target Value']) / datum['Target Value']) + \"% \" + if(datum['Actual Value'] === datum['Target Value'], \"−\", if(datum['Actual Value'] > datum['Target Value'], \"▲\",\"▼\"))",
        "as": "ActualLabel"
      },
      {"calculate": "0", "as": "dummy"}
    ],
    "layer": [
      {
        "description": "Target Value bars",
        "mark": {"type": "bar"},
        "encoding": {
          "x": {"field": "Target Value"},
          "fill": {"value": "#dddddd"},
          "stroke": {"value": "#aaaaaa"}
        }
      },
      {
        "description": "Actual Value bars",
        "mark": {"type": "bar", "opacity": 0.5},
        "encoding": {
          "x": {"field": "Actual Value"},
          "fill": {"field": "ActualState", "legend": null}
        }
      },
      {
        "description": "Actual Value strokes at end of bars",
        "mark": {
          "type": "point",
          "shape": "stroke",
          "angle": 90,
          "size": 300,
          "strokeWidth": 3
        },
        "encoding": {
          "x": {"field": "Actual Value"},
          "color": {"field": "ActualState"}
        }
      },
      {
        "description": "Actual Value labels at end of bars",
        "mark": {"type": "text", "align": "left", "dx": 5},
        "encoding": {
          "x": {"field": "Actual Value"},
          "color": {"field": "ActualState"},
          "text": {"field": "ActualLabel"}
        }
      },
      {
        "description": "Dummy to include Target in legend",
        "mark": {"type": "text"},
        "encoding": {"x": {"field": "dummy"}, "color": {"datum": "Target"}}
      }
    ],
    "encoding": {
      "x": {"type": "quantitative"},
      "y": {"field": "Category", "type": "nominal"}
    },
    "config": {}
  }